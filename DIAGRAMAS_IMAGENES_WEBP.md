# ğŸ¨ Diagramas: Sistema WebP

## Arquitectura General

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        NAVEGADOR                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  AddCabinModal / EditCabinModal                      â”‚  â”‚
â”‚  â”‚  - Usuario selecciona archivos                       â”‚  â”‚
â”‚  â”‚  - POST /api/upload/upload-images (FormData)         â”‚  â”‚
â”‚  â”‚  - Recibe: { imageUrls: [...] }                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ HTTP
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     BACKEND (Node.js)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  POST /api/upload/upload-images                      â”‚  â”‚
â”‚  â”‚  - Multer.array('images', 10)                        â”‚  â”‚
â”‚  â”‚  - Recibe archivos binarios                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â†“                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Sharp: Convertir a WebP                             â”‚  â”‚
â”‚  â”‚  - Input: PNG, JPEG, GIF                             â”‚  â”‚
â”‚  â”‚  - Output: WebP (calidad 80)                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â†“                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Guardar archivo                                     â”‚  â”‚
â”‚  â”‚  - backend/uploads/cabins/cabin-xxx.webp             â”‚  â”‚
â”‚  â”‚  - Generar URL: /uploads/cabins/cabin-xxx.webp       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â†“                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Response JSON                                       â”‚  â”‚
â”‚  â”‚  { imageUrls: ["/uploads/cabins/..."] }             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ HTTP
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        BASE DE DATOS                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Cabin {                                             â”‚  â”‚
â”‚  â”‚    id: "...",                                        â”‚  â”‚
â”‚  â”‚    title: "Mi CabaÃ±a",                               â”‚  â”‚
â”‚  â”‚    images: "["/uploads/cabins/cabin-xxx.webp"]"      â”‚  â”‚
â”‚  â”‚                          â†‘ Solo la URL               â”‚  â”‚
â”‚  â”‚  }                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flujo de Upload

```
â”Œâ”€ Usuario selecciona archivo
â”‚
â”œâ”€â†’ AddCabinModal.handleFileUpload()
â”‚   â””â”€â†’ new FormData()
â”‚   â””â”€â†’ formData.append('images', file)
â”‚
â”œâ”€â†’ POST /api/upload/upload-images
â”‚   â”œâ”€â†’ Multer: guarda en temp
â”‚   â”œâ”€â†’ Sharp: convierte a WebP
â”‚   â””â”€â†’ fs: guarda en /uploads/cabins/
â”‚
â”œâ”€â†’ Response: { imageUrls: ["/uploads/cabins/cabin-xxx.webp"] }
â”‚
â”œâ”€â†’ Frontend: agrega URL a imageList
â”‚
â””â”€â†’ POST /api/admin/cabins
    â””â”€â†’ BD: guarda { images: [...urls...] }
```

---

## ComparaciÃ³n ANTES vs DESPUÃ‰S

### ANTES: Base64

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Foto Original   â”‚  5 MB
â”‚    (JPEG)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â†’ JavaScript FileReader.readAsDataURL()
         â”‚
         â”œâ”€â†’ Convierte a Base64
         â”‚
         â””â”€â†’ "data:image/jpeg;base64,AAAA....BBBB" 
             6.7 MB (String)
             
             â”‚
             â”œâ”€â†’ JSON: { images: ["data:image/jpeg..."] }
             â”‚  6.7 MB
             â”‚
             â”œâ”€â†’ POST /api/admin/cabins
             â”‚  6.7 MB HTTP Request
             â”‚
             â”œâ”€â†’ BD: guarda string completo
             â”‚  6.7 MB en BD
             â”‚
             â””â”€â†’ Frontend: carga desde BD
                Descarga 6.7 MB cada vez
```

### DESPUÃ‰S: WebP + URLs

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Foto Original   â”‚  5 MB
â”‚    (JPEG)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â†’ FormData: formData.append('images', file)
         â”‚
         â”œâ”€â†’ POST /api/upload/upload-images
         â”‚  5 MB HTTP (binario)
         â”‚
         â”œâ”€â†’ Sharp: convierte a WebP
         â”‚  500 KB
         â”‚
         â””â”€â†’ Guarda: backend/uploads/cabins/cabin-xxx.webp
             â”‚
             â”œâ”€â†’ Response: { imageUrls: ["/uploads/cabins/cabin-xxx.webp"] }
             â”‚  30 bytes
             â”‚
             â”œâ”€â†’ POST /api/admin/cabins
             â”‚  30 bytes JSON
             â”‚
             â”œâ”€â†’ BD: guarda URL
             â”‚  30 bytes en BD
             â”‚
             â””â”€â†’ Frontend: GET /uploads/cabins/cabin-xxx.webp
                Descarga 500 KB desde archivos
                (CachÃ© en navegador)
```

---

## Estructura de Carpetas

```
amanwal/
â”‚
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â””â”€â”€ imageUpload.ts              â† Multer + Sharp
â”‚   â”‚   â”‚       â””â”€â”€ uploadImages middleware
â”‚   â”‚   â”‚       â””â”€â”€ convertToWebP()
â”‚   â”‚   â”‚       â””â”€â”€ getImageUrl()
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â””â”€â”€ upload.routes.ts            â† POST endpoint
â”‚   â”‚   â”‚       â””â”€â”€ /upload-images
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ server.ts                       â† Modificado
â”‚   â”‚       â””â”€â”€ app.use('/uploads', express.static(...))
â”‚   â”‚       â””â”€â”€ app.use('/api/upload', uploadRoutes)
â”‚   â”‚
â”‚   â””â”€â”€ uploads/                             â† Carpeta nueva
â”‚       â””â”€â”€ cabins/
â”‚           â”œâ”€â”€ cabin-1733347200000-123456789.webp
â”‚           â”œâ”€â”€ cabin-1733347205000-987654321.webp
â”‚           â””â”€â”€ ...
â”‚
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ src/
â”‚       â””â”€â”€ components/
â”‚           â”œâ”€â”€ AddCabinModal.tsx            â† Actualizado
â”‚           â”‚   â””â”€â”€ handleFileUpload() usa FormData
â”‚           â”‚
â”‚           â””â”€â”€ EditCabinModal.tsx           â† Actualizado
â”‚               â””â”€â”€ handleFileUpload() usa FormData
â”‚
â””â”€â”€ docs/
    â”œâ”€â”€ INSTALACION_IMAGENES_WEBP.md
    â”œâ”€â”€ PRUEBAS_SISTEMA_WEBP.md
    â””â”€â”€ README_IMAGENES_WEBP.md
```

---

## Timeline: Request/Response

```
NAVEGADOR                           SERVIDOR                        ALMACENAMIENTO
    â”‚                                  â”‚                                 â”‚
    â”‚ 1. Usuario selecciona foto       â”‚                                 â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚                                 â”‚
    â”‚                 â”‚                â”‚                                 â”‚
    â”‚ 2. FormData + POST /upload       â”‚                                 â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚                                 â”‚
    â”‚                                  â”‚ 3. Multer recibe               â”‚
    â”‚                                  â”œâ”€â”€â”€â”€â”€â”€â”                          â”‚
    â”‚                                  â”‚      â”‚ Guarda en temp           â”‚
    â”‚                                  â”‚ â†â”€â”€â”€â”€â”€â”¤                          â”‚
    â”‚                                  â”‚                                 â”‚
    â”‚                                  â”‚ 4. Sharp: PNG â†’ WebP            â”‚
    â”‚                                  â”œâ”€â”€â”€â”€â”€â”€â”                          â”‚
    â”‚                                  â”‚      â”‚ Procesa                  â”‚
    â”‚                                  â”‚ â†â”€â”€â”€â”€â”€â”¤ (1-2s)                  â”‚
    â”‚                                  â”‚                                 â”‚
    â”‚                                  â”‚ 5. fs: guardar archivo         â”‚
    â”‚                                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
    â”‚                                  â”‚                                 â”‚
    â”‚                                  â”‚ 6. Generar URL                  â”‚
    â”‚                                  â”‚ /uploads/cabins/cabin-xxx.webp  â”‚
    â”‚                                  â”‚                                 â”‚
    â”‚ 7. Response JSON                 â”‚                                 â”‚
    â”‚ { imageUrls: [...] }             â”‚                                 â”‚
    â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                 â”‚
    â”‚                                  â”‚                                 â”‚
    â”‚ 8. Agregar a lista               â”‚                                 â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚                                 â”‚
    â”‚                 â”‚                â”‚                                 â”‚
    â”‚ 9. POST /admin/cabins            â”‚                                 â”‚
    â”‚ (con URLs)                       â”‚                                 â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚                                 â”‚
    â”‚                                  â”‚                                 â”‚
    â”‚                                  â”‚ 10. Guardar en BD               â”‚
    â”‚                                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚
    â”‚                                  â”‚                                 â”‚ OK
    â”‚ 11. PÃ¡gina actualizada           â”‚                                 â”‚
    â”‚ (muestra imagen)                 â”‚                                 â”‚
    â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                 â”‚
```

---

## ComparaciÃ³n: CachÃ©

### ANTES: Sin cachÃ©

```
PÃ¡gina 1:
â”œâ”€â†’ GET /api/cabins/
â”œâ”€â†’ Descarga JSON 67 MB (10 imÃ¡genes)
â””â”€â†’ Tiempo: 10s

PÃ¡gina 2:
â”œâ”€â†’ GET /api/cabins/
â”œâ”€â†’ Descarga JSON 67 MB (idÃ©ntico)
â””â”€â†’ Tiempo: 10s âŒ Sin cachÃ©
```

### DESPUÃ‰S: Con cachÃ©

```
PÃ¡gina 1:
â”œâ”€â†’ GET /api/cabins/
â”œâ”€â†’ Descarga JSON 1 KB
â”œâ”€â†’ GET /uploads/cabins/img1.webp (500 KB)
â”œâ”€â†’ GET /uploads/cabins/img2.webp (500 KB)
â”œâ”€â†’ ...
â””â”€â†’ Tiempo: 3-5s

PÃ¡gina 2:
â”œâ”€â†’ GET /api/cabins/
â”œâ”€â†’ Descarga JSON 1 KB
â”œâ”€â†’ GET /uploads/cabins/img1.webp â† CACHÃ‰ âœ…
â”œâ”€â†’ GET /uploads/cabins/img2.webp â† CACHÃ‰ âœ…
â”œâ”€â†’ ...
â””â”€â†’ Tiempo: <1s ğŸš€
```

---

## Endpoints HTTP

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      UPLOAD DE IMÃGENES                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MÃ©todo:   POST                                              â”‚
â”‚ URL:      /api/upload/upload-images                         â”‚
â”‚ Content:  multipart/form-data                               â”‚
â”‚ Body:     images: [File, File, File]                        â”‚
â”‚ Response: { imageUrls: ["/uploads/cabins/..."] }            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   SERVIR IMÃGENES ESTÃTICAS                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MÃ©todo:   GET                                               â”‚
â”‚ URL:      /uploads/cabins/cabin-xxx.webp                    â”‚
â”‚ Response: archivo binario WebP                              â”‚
â”‚ Cache:    SÃ­ (HTTP Cache-Control)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Validaciones

```
Input (Frontend)
    â”‚
    â”œâ”€â†’ Tipo de archivo
    â”‚   â”œâ”€ âœ… JPEG
    â”‚   â”œâ”€ âœ… PNG
    â”‚   â”œâ”€ âœ… WebP
    â”‚   â”œâ”€ âœ… GIF
    â”‚   â””â”€ âŒ PDF, TXT, etc.
    â”‚
    â”œâ”€â†’ TamaÃ±o
    â”‚   â”œâ”€ âœ… < 10 MB
    â”‚   â””â”€ âŒ > 10 MB
    â”‚
    â””â”€â†’ Cantidad
        â”œâ”€ âœ… â‰¤ 10 archivos
        â””â”€ âŒ > 10 archivos

        â”‚
        â–¼
    
Processing (Backend)
    â”‚
    â”œâ”€â†’ Sharp: Validar imagen
    â”‚   â”œâ”€ âœ… Imagen vÃ¡lida
    â”‚   â””â”€ âŒ Imagen corrupta
    â”‚
    â”œâ”€â†’ Sharp: Convertir a WebP
    â”‚   â”œâ”€ âœ… OK
    â”‚   â””â”€ âŒ Error formato
    â”‚
    â””â”€â†’ fs: Guardar archivo
        â”œâ”€ âœ… Guardado
        â””â”€ âŒ Sin permisos
```

